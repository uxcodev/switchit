{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport MainNav from \"@/components/layout/MainNav.vue\";\nimport api from \"@/api/switchit\";\nimport jwt_decode from \"jwt-decode\";\nexport default {\n  components: {\n    MainNav\n  },\n  name: \"App\",\n  data() {\n    return {\n      auth0User: this.$auth0.user,\n      user: () => {\n        this.$store.getters.user;\n      }\n    };\n  },\n  watch: {\n    async auth0User(auth0User) {\n      if (auth0User) {\n        // create token on backend from logged in email\n        // this also checks switchit db for a user, and\n        // returns the user info in the token\n\n        let token = await api.createToken(auth0User.email);\n\n        // get the user info from the returned token and\n        // save it in VueX\n\n        let decodedToken = await jwt_decode(token);\n        await this.$store.dispatch('setUser', decodedToken.user);\n\n        // if there is no user in the switchit db, push \n        // to onboarding\n\n        if (decodedToken.user === null) {\n          this.$router.push({\n            path: '/onboarding'\n          });\n        }\n        // console.log('decodedToken.user')\n        // console.log(decodedToken.user)\n\n        // if the user is admin, save to VueX\n\n        console.log(decodedToken);\n        if (decodedToken.user && decodedToken.user.admin) {\n          this.$store.dispatch('isAdmin', decodedToken.user.admin);\n        }\n        if (decodedToken.user.status === 'new' || decodedToken.user.status === 'pending') {\n          this.$router.push({\n            path: '/onboarding'\n          });\n        }\n      }\n    }\n  }\n};","map":{"version":3,"mappings":";AAWA,OAAOA,OAAM,MAAO,iCAAiC;AACrD,OAAOC,GAAE,MAAO,gBAAgB;AAChC,OAAOC,UAAS,MAAO,YAAY;AAEnC,eAAe;EACbC,UAAU,EAAE;IACVH;EACF,CAAC;EACDI,IAAI,EAAE,KAAK;EACXC,IAAI,GAAG;IACL,OAAO;MACLC,SAAS,EAAE,IAAI,CAACC,MAAM,CAACC,IAAI;MAC3BA,IAAI,EAAE,MAAM;QAAE,IAAI,CAACC,MAAM,CAACC,OAAO,CAACF,IAAG;MAAE;IACzC,CAAC;EACH,CAAC;EACDG,KAAK,EAAE;IACL,MAAML,SAAS,CAACA,SAAS,EAAE;MACzB,IAAIA,SAAS,EAAE;QAEb;QACA;QACA;;QAEA,IAAIM,KAAI,GAAI,MAAMX,GAAG,CAACY,WAAW,CAACP,SAAS,CAACQ,KAAK;;QAEjD;QACA;;QAEA,IAAIC,YAAW,GAAI,MAAMb,UAAU,CAACU,KAAK;QACzC,MAAM,IAAI,CAACH,MAAM,CAACO,QAAQ,CAAC,SAAS,EAAED,YAAY,CAACP,IAAI;;QAEvD;QACA;;QAEA,IAAIO,YAAY,CAACP,IAAG,KAAM,IAAI,EAAE;UAC9B,IAAI,CAACS,OAAO,CAACC,IAAI,CAAC;YAAEC,IAAI,EAAE;UAAc,CAAC;QAC3C;QACA;QACA;;QAEA;;QAEAC,OAAO,CAACC,GAAG,CAACN,YAAY;QACxB,IAAIA,YAAY,CAACP,IAAG,IAAKO,YAAY,CAACP,IAAI,CAACc,KAAK,EAAE;UAChD,IAAI,CAACb,MAAM,CAACO,QAAQ,CAAC,SAAS,EAAED,YAAY,CAACP,IAAI,CAACc,KAAK;QACzD;QAEA,IAAIP,YAAY,CAACP,IAAI,CAACe,MAAK,KAAM,KAAI,IAAKR,YAAY,CAACP,IAAI,CAACe,MAAK,KAAM,SAAS,EAAE;UAChF,IAAI,CAACN,OAAO,CAACC,IAAI,CAAC;YAAEC,IAAI,EAAE;UAAc,CAAC;QAC3C;MACF;IACF;EACF;AACF,CAAC","names":["MainNav","api","jwt_decode","components","name","data","auth0User","$auth0","user","$store","getters","watch","token","createToken","email","decodedToken","dispatch","$router","push","path","console","log","admin","status"],"sourceRoot":"","sources":["/Users/nick/Sites/switchit/vue/src/App.vue"],"sourcesContent":["<template>\n  <MainNav />\n  <div id=\"app\">\n    <router-view></router-view>\n    <!-- <div class=\"main\">\n      Waiting for authorization...\n    </div> -->\n  </div>\n</template>\n\n<script>\nimport MainNav from \"@/components/layout/MainNav.vue\";\nimport api from \"@/api/switchit\";\nimport jwt_decode from \"jwt-decode\";\n\nexport default {\n  components: {\n    MainNav,\n  },\n  name: \"App\",\n  data() {\n    return {\n      auth0User: this.$auth0.user,\n      user: () => { this.$store.getters.user }\n    };\n  },\n  watch: {\n    async auth0User(auth0User) {\n      if (auth0User) {\n\n        // create token on backend from logged in email\n        // this also checks switchit db for a user, and\n        // returns the user info in the token\n\n        let token = await api.createToken(auth0User.email)\n\n        // get the user info from the returned token and\n        // save it in VueX\n\n        let decodedToken = await jwt_decode(token)\n        await this.$store.dispatch('setUser', decodedToken.user)\n\n        // if there is no user in the switchit db, push \n        // to onboarding\n\n        if (decodedToken.user === null) {\n          this.$router.push({ path: '/onboarding' })\n        }\n        // console.log('decodedToken.user')\n        // console.log(decodedToken.user)\n\n        // if the user is admin, save to VueX\n\n        console.log(decodedToken)\n        if (decodedToken.user && decodedToken.user.admin) {\n          this.$store.dispatch('isAdmin', decodedToken.user.admin)\n        }\n\n        if (decodedToken.user.status === 'new' || decodedToken.user.status === 'pending') {\n          this.$router.push({ path: '/onboarding' })\n        }\n      }\n    }\n  },\n};\n</script>\n\n<style lang=\"sass\">\n@import \"/src/styles/styles.sass\"\n\n\n\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}